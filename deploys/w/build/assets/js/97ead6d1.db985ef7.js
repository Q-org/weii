"use strict";(self.webpackChunkwei=self.webpackChunkwei||[]).push([[1666],{2438:(e,n,r)=>{r.r(n),r.d(n,{default:()=>C});var t=r(78910),s=r(60646),a=r(30758),i=r(88220),c=r(17018),u=r(95822),o=r(85968),l=r(93835),f=r(41301),h=r(86070);const p=function(e){var n=e.startIcon,r=void 0===n?l.A:n,i=e.endIcon,c=e.isBusy,u=e.onClick,p=(0,a.useState)(c),x=p[0],d=p[1];(0,a.useEffect)((function(){d(c)}),[c]);var v=function(){var e=(0,s.A)((0,t.A)().mark((function e(){var n;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d(!0),e.prev=1,n=u(),!f.A.isPromise(n)){e.next=6;break}return e.next=6,n;case 6:return e.prev=6,d(!1),e.finish(6);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,null,[[1,,6,9]])})));return function(){return e.apply(this,arguments)}}();return(0,h.jsxs)(o.A,{onClick:v,disabled:x,children:[(0,h.jsx)(r,{}),i&&(0,h.jsx)(i,{})]})};var x=r(39986),d=r(41154),v=r(15875),m=r(16073),A=r(22779),j=r(9870),g=r(29792),k=r.n(g);const y=function(e){var n=e.photo;return(0,h.jsxs)(v.A,{sx:{maxWidth:345},children:[(0,h.jsx)(j.A,{component:"img",height:"194",image:n.urls.small,alt:n.alt_description}),(0,h.jsxs)(m.A,{disableSpacing:!0,children:[(0,h.jsxs)(o.A,{"aria-label":"add to favorites",href:n.links.like,target:"_blank",size:"small",children:[(0,h.jsx)(A.A,{}),n.likes]}),(0,h.jsx)(o.A,{"aria-label":"share",href:n.links.download,target:"_blank",size:"small",children:(0,h.jsx)(k(),{})}),(0,h.jsxs)(d.A,{variant:"caption",sx:{marginLeft:"auto"},children:["By ",n.user.name]})]})]})};const b=function(e){var n=e.photos,r=e.error,t=e.loaderRef;return(0,h.jsxs)(x.Ay,{container:!0,spacing:2,justifyContent:"center",children:[r&&(0,h.jsx)(x.Ay,{item:!0,xs:12,children:(0,h.jsx)(d.A,{variant:"h6",color:"error",align:"center",children:r})}),n.map((function(e){return(0,h.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,h.jsx)(y,{photo:e})},e.id)})),(0,h.jsx)("div",{ref:t,style:{height:"20px"}})]})};var w=(0,i.xP)({accessKey:"bN4a8VW7eenpkvpLL_O4KYYmLJRDJLfm7Eivoww1cuU"});const C=function(){var e=(0,a.useState)(""),n=e[0],r=e[1],i=(0,a.useState)([]),o=i[0],f=i[1],d=(0,a.useState)(null),v=d[0],m=d[1],A=(0,a.useState)(1),j=A[0],g=A[1],k=(0,a.useState)(!1),y=k[0],C=k[1],S=(0,a.useRef)(null),E=(0,a.useRef)(null),I=function(){var e=(0,s.A)((0,t.A)().mark((function e(n,r){var s;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.prev=1,e.next=4,w.search.getPhotos({query:n,page:r,perPage:12});case 4:"success"===(s=e.sent).type?(f((function(e){return[].concat(e,s.response.results)})),m(null)):(m(s.errors[0]),f([])),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),m(e.t0.message),f([]);case 12:return e.prev=12,C(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(n,r){return e.apply(this,arguments)}}(),L=function(){var e=(0,s.A)((0,t.A)().mark((function e(){return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E.current&&clearTimeout(E.current),f([]),g(1),I(n,1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){var e=new IntersectionObserver((function(e){var n;null!=e&&null!=(n=e[0])&&n.isIntersecting&&g((function(e){return e+1}))}),{threshold:1});return S.current&&e.observe(S.current),function(){S.current&&e.unobserve(S.current)}}),[]),(0,a.useEffect)((function(){j>1&&I(n,j)}),[j]),(0,h.jsxs)(c.A,{sx:{marginTop:4},children:[(0,h.jsxs)(x.Ay,{container:!0,spacing:2,justifyContent:"center",children:[(0,h.jsx)(x.Ay,{item:!0,xs:10,sm:8,md:6,children:(0,h.jsx)(u.A,{fullWidth:!0,label:"\u7167\u7247",variant:"outlined",value:n,onChange:function(e){r(e.target.value),E.current&&clearTimeout(E.current),E.current=window.setTimeout((function(){f([]),g(1),I(e.target.value,1)}),3e3)},onKeyPress:function(e){"Enter"===e.key&&(E.current&&clearTimeout(E.current),f([]),g(1),I(n,1))},sx:{marginBottom:2},autoComplete:"on"})}),(0,h.jsx)(x.Ay,{item:!0,xs:2,sm:1,children:(0,h.jsx)(p,{startIcon:l.A,isBusy:y,onClick:L})})]}),(0,h.jsx)(b,{photos:o,error:v,loaderRef:S})]})}}}]);