"use strict";(self.webpackChunkwei=self.webpackChunkwei||[]).push([[173],{19265:(e,r,n)=>{n.d(r,{A:()=>s});var t=n(6316),a=n(86070);const s=(0,t.A)((0,a.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")},85087:(e,r,n)=>{n.r(r),n.d(r,{default:()=>S});var t=n(78910),a=n(60646),s=n(30758),o=n(39986),c=n(15875),i=n(39486),u=n(98667),l=n(41154),d=n(16073),p=n(6316),h=n(86070);const f=(0,p.A)((0,h.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"}),"Mic");var v=n(5565);const x=(0,p.A)((0,h.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),m=(0,p.A)((0,h.jsx)("path",{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.11-.9-2-2-2H4c-1.11 0-2 .89-2 2v10c0 1.1.89 2 2 2H0v2h24v-2zm-7-3.53v-2.19c-2.78 0-4.61.85-6 2.72.56-2.67 2.11-5.33 6-5.87V7l4 3.73z"}),"ScreenShare");var g=n(79443),A=n(19265);function b(e){var r,n=s.useState(!1),o=n[0],c=n[1],i=null!=(r=e=Object.assign({title:"Simple",alt:"Simple",size:"small",variant:"contained",loading:o,loadingPosition:"start",disabled:!1,startIcon:(0,h.jsx)(A.A,{})},e))&&r.handleclick?(0,a.A)((0,t.A)().mark((function r(){var n;return(0,t.A)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c(!0),r.next=3,null==(n=e)?void 0:n.handleclick();case 3:c(!1);case 4:case"end":return r.stop()}}),r)}))):function(){setTimeout((function(){c(!1)}),2e3)},u=Object.assign({},e,{handleclick:void 0});return(0,h.jsx)(g.A,Object.assign({},u,{onClick:i,children:(0,h.jsx)("span",{children:e.title||""})}))}var j={enableHighAccuracy:!0,timeout:1e4,maximumAge:1e4};function k(e){return y.apply(this,arguments)}function y(){return(y=(0,a.A)((0,t.A)().mark((function e(r){var n,a,s;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=function(e){}),n="\u672a\u77e5",!navigator.permissions||!navigator.permissions.query){e.next=14;break}return e.prev=3,e.next=6,navigator.permissions.query({name:"microphone"});case 6:a=e.sent,n=a.state,r(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.warn("navigator.permissions.query \u4e0d\u652f\u6301 microphone\uff0c\u5c1d\u8bd5 getUserMedia");case 14:if("\u672a\u77e5"!==n){e.next=27;break}return e.prev=15,e.next=18,navigator.mediaDevices.getUserMedia({audio:!0});case 18:s=e.sent,s.getAudioTracks().forEach((function(e){return e.stop()})),n="granted",e.next=27;break;case 24:e.prev=24,e.t1=e.catch(15),"NotAllowedError"===e.t1.name?n="denied":(console.error("Error getting microphone stream:",e.t1.message),n="\u53d1\u751f\u9519\u8bef\uff1a"+e.t1.message);case 27:return e.abrupt("return",n);case 28:case"end":return e.stop()}}),e,null,[[3,11],[15,24]])})))).apply(this,arguments)}const w=function(){var e=(0,s.useState)("\u672a\u77e5"),r=e[0],n=e[1],o=(0,s.useState)(null),c=o[0],i=o[1],u=(0,s.useState)(null),l=u[0],d=u[1],p=(0,s.useCallback)((0,a.A)((0,t.A)().mark((function e(){var r,a;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({video:!0});case 3:r=e.sent,i(r),d(null),n("granted"),e.next=15;break;case 9:e.prev=9,e.t0=e.catch(0),a="An unknown error occurred during screen capture.","NotAllowedError"===e.t0.name?(a="Screen capture authorization has been denied.",n("denied")):"NotFoundError"===e.t0.name?(a="No media devices were found for screen capture.",n("not-found")):"NotReadableError"===e.t0.name?(a="The screen capture stream could not be read.",n("not-readable")):n("error"),d(a),console.error("Screen capture error: "+a,e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,9]])}))),[]),h=(0,s.useCallback)((function(){c&&(c.getTracks().forEach((function(e){return e.stop()})),i(null),n("stopped"))}),[c]);return{screenCapturePermission:r,screenStream:c,captureError:l,requestScreenCapturePermission:p,stopScreenCapture:h}};const S=function(){var e,r,n=function(){var e=(0,s.useState)("\u672a\u77e5"),r=e[0],n=e[1],o=(0,s.useState)(null),c=o[0],i=o[1],u=(0,s.useState)(!1),l=u[0],d=u[1],p=new AbortController;p.signal,(0,s.useEffect)((function(){return function(){p.abort()}}),[]);var h=(0,s.useCallback)((0,a.A)((0,t.A)().mark((function e(){var r;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.permissions.query({name:"geolocation"});case 3:r=e.sent,n(r.state),"granted"===r.state&&f(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error querying geolocation permission:",e.t0.message),n("\u5f85\u786e\u8ba4");case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),[]),f=(0,s.useCallback)((0,a.A)((0,t.A)().mark((function e(){var a,s;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"!==r){e.next=19;break}return e.prev=1,d(!0),(a=new AbortController).signal,e.next=7,new Promise((function(e,r){return navigator.geolocation.getCurrentPosition(e,r,j),function(){return a.abort()}}));case 7:s=e.sent,i({latitude:s.coords.latitude,longitude:s.coords.longitude}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),"AbortError"!==e.t0.name&&console.error("Error getting geolocation:",e.t0.message),n("\u5df2\u62d2\u7edd"),i(null);case 16:return e.prev=16,d(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,11,16,19]])}))),[r]);return{geolocationPermission:r,location:c,busy:l,requestGeolocationPermission:h,getLocation:f}}(),p=n.geolocationPermission,g=n.location,A=n.requestGeolocationPermission,y=n.getLocation,S=function(){var e=(0,s.useState)("\u672a\u77e5"),r=e[0],n=e[1],o=(0,s.useState)(!1),c=o[0],i=o[1],u=(0,s.useRef)(null),l=(0,s.useCallback)((0,a.A)((0,t.A)().mark((function e(){return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(!0),k().then((function(e){n(e)})).finally((function(){return i(!1)}));case 2:case"end":return e.stop()}}),e)}))),[]),d=(0,s.useCallback)((function(){u.current&&(u.current.getAudioTracks().forEach((function(e){return e.stop()})),u.current=null,n("\u5df2\u91ca\u653e"))}),[]),p=(0,s.useCallback)(function(){var e=(0,a.A)((0,t.A)().mark((function e(n){var a;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("\u5df2\u6388\u6743"!==r){e.next=16;break}return e.prev=1,i(!0),e.next=5,navigator.mediaDevices.getUserMedia(n);case 5:return a=e.sent,e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(1),console.error("Error getting microphone stream:",e.t0.message),e.abrupt("return",null);case 13:return e.prev=13,i(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,9,13,16]])})));return function(r){return e.apply(this,arguments)}}(),[r]);return(0,s.useEffect)((function(){return l(),function(){d()}}),[l,d]),{microphonePermission:r,busy:c,requestMicrophonePermission:l,stopUsingMicrophone:d,usingMicrophone:p}}(),E=S.microphonePermission,M=(S.busy,S.requestMicrophonePermission,S.stopUsingMicrophone),P=S.usingMicrophone,q=w(),N=q.screenCapturePermission,z=q.screenStream,T=q.requestScreenCapturePermission,U=q.stopScreenCapture,D=(0,s.useState)("\u672a\u77e5"),H=D[0],L=D[1];return(0,s.useEffect)((function(){A()}),[A]),(0,s.useEffect)((function(){navigator.permissions.query({name:"notifications"}).then((function(e){L(e.state),e.onchange=function(){L(e.state)}})).catch((function(e){console.error(e.message)}))}),[]),(0,h.jsxs)("div",{children:[(0,h.jsx)("h1",{children:"\u6d4f\u89c8\u5668\u6743\u9650"}),(0,h.jsx)("p",{children:"\u672c\u9875\u9762\u663e\u793a\u60a8\u7684\u6d4f\u89c8\u5668\u7684\u4e00\u4e9b\u6743\u9650\u3002"}),(0,h.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,h.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,h.jsxs)(c.A,{children:[(0,h.jsx)(i.A,{avatar:(0,h.jsx)(v.A,{}),title:"\u5b9a\u4f4d\u6743\u9650",subheader:p}),(0,h.jsxs)(u.A,{children:[(0,h.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"\u6b64\u6743\u9650\u5141\u8bb8\u5fae\u5fae\u8bbf\u95ee\u60a8\u7684\u4f4d\u7f6e\u4fe1\u606f\u3002"}),g&&(0,h.jsxs)(l.A,{variant:"body2",color:"text.primary",children:["\u7eac\u5ea6: ",(null==g||null==(e=g.latitude)?void 0:e.toFixed(4))||null,", \u7ecf\u5ea6:",(null==g||null==(r=g.longitude)?void 0:r.toFixed(4))||null]})]}),(0,h.jsx)(d.A,{children:(0,h.jsx)(b,{title:"granted"===p?"\u83b7\u53d6\u4f4d\u7f6e":"\u8bf7\u6c42\u6743\u9650",handleclick:"granted"===p?y:A})})]})}),(0,h.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,h.jsxs)(c.A,{children:[(0,h.jsx)(i.A,{avatar:(0,h.jsx)(f,{}),title:"\u9ea6\u514b\u98ce\u6743\u9650",subheader:E}),(0,h.jsx)(u.A,{children:(0,h.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"\u6b64\u6743\u9650\u5141\u8bb8\u5fae\u5fae\u8bbf\u95ee\u60a8\u7684\u9ea6\u514b\u98ce\u8bbe\u5907\u3002"})}),(0,h.jsx)(d.A,{children:(0,h.jsx)(b,{title:"granted"===E?"\u4f7f\u7528MIC":"\u8bf7\u6c42\u6743\u9650",handleclick:"granted"===E?P:M})})]})}),(0,h.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,h.jsxs)(c.A,{children:[(0,h.jsx)(i.A,{avatar:(0,h.jsx)(x,{}),title:"\u6d88\u606f\u6743\u9650",subheader:H}),(0,h.jsx)(u.A,{children:(0,h.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"\u6b64\u6743\u9650\u5141\u8bb8\u5fae\u5fae\u5411\u60a8\u53d1\u9001\u901a\u77e5\u3002"})}),(0,h.jsx)(d.A,{children:(0,h.jsx)(b,{variant:"contained",color:"primary",title:"granted"===H?"\u53d1\u9001\u6d88\u606f":"\u8bf7\u6c42\u6743\u9650",handleclick:function(){return C(H,L)}})})]})}),(0,h.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,h.jsxs)(c.A,{children:[(0,h.jsx)(i.A,{avatar:(0,h.jsx)(m,{}),title:"\u5c4f\u5e55\u6355\u6349\u6743\u9650",subheader:N}),(0,h.jsxs)(u.A,{children:[(0,h.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"\u6b64\u6743\u9650\u5141\u8bb8\u5fae\u5fae\u8bbf\u95ee\u60a8\u7684\u5c4f\u5e55\u5185\u5bb9\u3002"}),z&&(0,h.jsx)(l.A,{variant:"body2",color:"text.primary",children:"\u5c4f\u5e55\u6355\u6349\u5df2\u542f\u7528\u3002"})]}),(0,h.jsx)(d.A,{children:(0,h.jsx)(b,{title:"granted"===N?"\u505c\u6b62\u6355\u6349":"\u8bf7\u6c42\u6743\u9650",handleclick:"granted"===N?U:T})})]})})]})]})};var C=function(){var e=(0,a.A)((0,t.A)().mark((function e(r,n){return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"granted"!==r){e.next=5;break}e.next=7;break;case 5:return e.next=7,Notification.requestPermission();case 7:if(n(r),"granted"!==r){e.next=11;break}return e.next=11,new Notification("\u60a8\u597d\uff0c\u8fd9\u662f\u4e00\u4e2a\u6d4b\u8bd5\u901a\u77e5\uff01");case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),n("\u5f85\u786e\u8ba4"),console.error(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(r,n){return e.apply(this,arguments)}}()}}]);