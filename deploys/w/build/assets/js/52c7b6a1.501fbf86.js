"use strict";(self.webpackChunkwei=self.webpackChunkwei||[]).push([[7674],{16153:(e,t,n)=>{n.d(t,{A:()=>x});var r=n(30758),o=n(13526),a=n(82682),i=n(73493),s=n(41154),c=n(44135),u=n(23927),l=n(59901),d=n(38896),p=n(90768),f=n(1020),v=n(58204);function m(e){return(0,v.Ay)("MuiInputAdornment",e)}const h=(0,f.A)("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var g,A=n(86070);const S=(0,l.Ay)("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${(0,i.A)(n.position)}`],!0===n.disablePointerEvents&&t.disablePointerEvents,t[n.variant]]}})((0,d.A)((({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${h.positionStart}&:not(.${h.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]})))),x=r.forwardRef((function(e,t){const n=(0,p.b)({props:e,name:"MuiInputAdornment"}),{children:l,className:d,component:f="div",disablePointerEvents:v=!1,disableTypography:h=!1,position:x,variant:w,...b}=n,y=(0,u.A)()||{};let D=w;w&&y.variant,y&&!D&&(D=y.variant);const j={...n,hiddenLabel:y.hiddenLabel,size:y.size,disablePointerEvents:v,position:x,variant:D},k=(e=>{const{classes:t,disablePointerEvents:n,hiddenLabel:r,position:o,size:s,variant:c}=e,u={root:["root",n&&"disablePointerEvents",o&&`position${(0,i.A)(o)}`,c,r&&"hiddenLabel",s&&`size${(0,i.A)(s)}`]};return(0,a.A)(u,m,t)})(j);return(0,A.jsx)(c.A.Provider,{value:null,children:(0,A.jsx)(S,{as:f,ownerState:j,className:(0,o.A)(k.root,d),ref:t,...b,children:"string"!=typeof l||h?(0,A.jsxs)(r.Fragment,{children:["start"===x?g||(g=(0,A.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):null,l]}):(0,A.jsx)(s.A,{color:"textSecondary",children:l})})})}))},93940:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var r=n(78910),o=n(60646),a=n(30758),i=n(42763),s=n(17018),c=n(41154),u=n(95527),l=n(95822),d=n(16153),p=n(85968),f=n(48366),v=n(86070);const m=function(e){var t=e.label,n=e.value,r=e.onClick,o=(0,a.useState)(n),i=o[0],s=o[1];return(0,v.jsx)(l.A,{label:t,value:i,onChange:function(e){s(e.target.value)},fullWidth:!0,margin:"normal",InputProps:{endAdornment:i&&(0,v.jsx)(d.A,{position:"end",children:(0,v.jsx)(p.A,{onClick:function(){i.trim()&&(r(i),s(""))},children:(0,v.jsx)(f.A,{})})})}})};var h,g=n(54817),A=n(30682),S=n(81168),x=n(93419),w=n(16338),b=function(){function e(){}return e.debounce=function(e,t){var n=null;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];n&&clearTimeout(n),n=setTimeout((function(){e.apply(void 0,o)}),t)}},e.getFormattedTime=function(){var e=new Date;return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+" "+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")},e.getFormattedTimeISO=function(){var e=new Date;return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")+"Z"},e.generateTimeFileName=function(e,t){return void 0===e&&(e=new Date),void 0===t&&(t="md"),t=t.replace(/^\.(?=.)/,""),e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+"-"+String(e.getMinutes()).padStart(2,"0")+"-"+String(e.getSeconds()).padStart(2,"0")+"Z."+t},e}();h=b,b.toSeconds=function(e,t){if(void 0===t&&(t=1),"number"==typeof e)return e;var n=e.match(/^\s*(\d+)\s*(\u79d2|\u5206\u949f|\u5c0f\u65f6|\u6beb\u79d2|s(ec(ond)?)?|m(in(ute)?)?|h(our)?|ms|millisecond)\s*$/i);if(!n)throw new Error("\u65e0\u6548\u7684\u65f6\u95f4\u683c\u5f0f");var r=parseInt(n[1],10);switch(n[2].toLowerCase().toLowerCase()){case"\u79d2":case"sec":case"s":case"second":return r*t;case"\u5206\u949f":case"min":case"m":case"minute":return 60*r*t;case"\u5c0f\u65f6":case"h":case"hour":return 60*r*60*t;case"\u6beb\u79d2":case"ms":case"millisecond":return r;default:throw new Error("\u65e0\u6548\u7684\u65f6\u95f4\u5355\u4f4d")}},b.toMillisecond=function(e){return h.toSeconds(e,1e3)},b.timer=function(e,t,n){return void 0===t&&(t=1e3),n&&e?setInterval(n,h.toMillisecond(t)):null},b.formatTime=function(e){var t,n="string"==typeof e?new Date(e):e,r=(new Date).getTime()-n.getTime(),o=6e4,a=36e5,i=24*a,s=365*i;if(r<o)t=Math.floor(r/1e3)+" \u79d2";else if(r<a)t=Math.floor(r/o)+" \u5206\u949f";else if(r<i)t=Math.floor(r/a)+" \u5c0f\u65f6";else if(r<3*i){t=Math.floor(r/i)+" \u5929 "+Math.floor(r%i/a)+" \u5c0f\u65f6\u524d"}else t=r<s?null==n?void 0:n.toLocaleDateString(void 0,{month:"long",day:"numeric"}):null==n?void 0:n.toLocaleDateString(void 0,{year:"numeric",month:"long"});return{localDate:n,displayDate:t}};var y=n(59901),D=["processed","children"],j=(0,y.Ay)((function(e){e.processed;var t=e.children,n=(0,w.A)(e,D);return(0,v.jsx)(c.A,Object.assign({},n,{children:t}))}))((function(e){e.theme;var t=e.processed;return Object.assign({},t&&{variant:"overline",opacity:.2})}));const k=function(e){var t=e.timestamp,n=e.label,r=(0,a.useState)((function(){return b.formatTime(t)})),o=r[0],i=r[1];return(0,a.useEffect)((function(){var e=o.localDate,n=(new Date).getTime()-e.getTime(),r=function(){return i(b.formatTime(t))},a=null;n<6e4?a=b.timer(t,"1\u79d2",r):n<36e5?a=b.timer(t,"1\u5206\u949f",r):n<864e5&&(a=b.timer(t,"1\u5c0f\u65f6",r));var s=b.debounce((function(){a&&clearInterval(a)}),1e3);return function(){s()}}),[t,o]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(j,{component:"span",variant:"overline",children:[n&&n+": ",o.displayDate]}),(0,v.jsxs)(c.A,{component:"span",variant:"overline",children:[n&&n+": ",o.displayDate]})]})};const T=function(e){var t=e.todo,n=e.onToggleComplete,r=e.onDelete,o=(0,a.useState)(!1),i=o[0],s=o[1],c=function(){return s(!0)},u=function(){return s(!1)};return(0,v.jsxs)(g.Ay,{divider:!0,onMouseEnter:c,onMouseLeave:u,onTouchStart:c,onTouchEnd:u,style:{borderBottom:i?"2px solid #1976d2":"none"},children:[(0,v.jsx)(A.A,{checked:t.completed,onChange:function(){return n(t._id)},disabled:t.completed}),(0,v.jsx)(S.A,{primary:t.title,secondary:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(k,{timestamp:t.createdAt,"aria-label":"Created"}),!1]}),style:{textDecoration:t.completed?"line-through":"none"}}),i&&(0,v.jsx)(p.A,{edge:"end",onClick:function(){return r(t._id)},children:(0,v.jsx)(x.A,{})})]})};const M=function(){var e=(0,a.useState)(null),t=e[0],n=e[1],l=(0,a.useState)(!1),d=l[0],p=l[1],f=(0,a.useState)([]),h=f[0],g=f[1],A=(0,a.useContext)(i.Lv),S=A.getPouchDBAsync,x=A.getPouchDBsync,w=A.isPouchDBRefReady;(0,a.useEffect)((function(){var e;d||(0,o.A)((0,r.A)().mark((function t(){return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(w){t.next=8;break}return t.next=3,S("todos");case 3:e=t.sent,n(e),p(!0),t.next=9;break;case 8:w&&!d&&(e=x("todos"),n(e),p(!0));case 9:case"end":return t.stop()}}),t)})))()}),[w,d,S,x]),(0,a.useEffect)((function(){if(t){var e=function(){var e=(0,o.A)((0,r.A)().mark((function e(){var n;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.allDocs({include_docs:!0});case 3:(n=e.sent).rows.length>0&&g(n.rows.map((function(e){return e.doc}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to fetch todos:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}}),[d,t]);var b=function(){var e=(0,o.A)((0,r.A)().mark((function e(n){var o;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n.trim()){e.next=2;break}return e.abrupt("return");case 2:return o={_id:(new Date).toISOString(),title:n,completed:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},e.prev=3,e.next=6,null==t?void 0:t.put(o);case 6:g((function(e){return[].concat(e,[o])})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Failed to add todo:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,o.A)((0,r.A)().mark((function e(n){var o,a;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=h.find((function(e){return e._id===n})))){e.next=12;break}return a=Object.assign({},o,{completed:!o.completed,updatedAt:(new Date).toISOString()}),e.prev=3,e.next=6,null==t?void 0:t.put(a);case 6:g((function(e){return e.map((function(e){return e._id===n?a:e}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Failed to update todo:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,o.A)((0,r.A)().mark((function e(n){var o;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=h.find((function(e){return e._id===n})))){e.next=11;break}return e.prev=2,e.next=5,null==t?void 0:t.remove(o);case 5:g((function(e){return e.filter((function(e){return e._id!==n}))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Failed to delete todo:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),j=h.sort((function(e,t){return e.completed===t.completed?new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime():e.completed?1:-1}));return(0,v.jsxs)(s.A,{children:[(0,v.jsx)(c.A,{variant:"h4",gutterBottom:!0,children:"Todo List"}),(0,v.jsx)(m,{label:"Add a new todo",value:"",onClick:b}),(0,v.jsx)(u.A,{children:j.map((function(e){return(0,v.jsx)(T,{todo:e,onToggleComplete:y,onDelete:D},e._id)}))})]})}}}]);