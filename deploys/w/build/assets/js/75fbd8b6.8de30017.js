"use strict";(self.webpackChunkwei=self.webpackChunkwei||[]).push([[3807],{1932:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(78910),s=n(60646),a=n(30758),i=n(79414),c=n(3854),u=n(90416),o=n(22779),h=n(25755),l=n(86070),d=function(e){return e[e.IDLE=0]="IDLE",e[e.READING=1]="READING",e[e.PAUSED=2]="PAUSED",e[e.FINISHED=3]="FINISHED",e}(d||{}),p=function(){function e(){this.currentSpeech=null,this.readingState=d.IDLE}var t=e.prototype;return t.getTextToRead=function(e){var t=document.querySelectorAll("h1,h2,p"),n="";return t.forEach((function(e){n+=e.innerText+" "})),n},t.startReading=function(e,t){return void 0===e&&(e=this.currentSpeech),void 0===t&&(t=this.readingState),e||(this.currentSpeech||(this.currentSpeech=new SpeechSynthesisUtterance,this.currentSpeech.text=this.getTextToRead(),this.currentSpeech.lang="zh-CN"),e=this.currentSpeech.text),t===d.READING?this.pauseReading():t===d.PAUSED?this.resumeReading():t===d.IDLE&&(this.cancelReading(),this.currentSpeech=new SpeechSynthesisUtterance,this.currentSpeech.text=e,this.currentSpeech.lang="zh-CN",window.speechSynthesis.speak(this.currentSpeech),this.readingState=d.READING),this.readingState},t.pauseReading=function(){this.readingState===d.READING&&(window.speechSynthesis.pause(),this.readingState=d.PAUSED)},t.resumeReading=function(){this.readingState===d.PAUSED&&(window.speechSynthesis.resume(),this.readingState=d.READING)},t.replaceReading=function(){this.cancelReading()},t.cancelReading=function(){this.readingState!==d.IDLE&&(window.speechSynthesis.cancel(),this.readingState=d.IDLE)},e}();var f=n(55076),S=n(25234),g=n(76096);function v(){var e=(0,a.useRef)(null),t=(0,a.useState)(!1),i=t[0],c=t[1],u=function(){var t=(0,s.A)((0,r.A)().mark((function t(){var a;return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getDisplayMedia({video:!0});case 3:return a=t.sent,c(!0),t.abrupt("return",n.e(3779).then(n.bind(n,73779)).then(function(){var t=(0,s.A)((0,r.A)().mark((function t(n){var s;return(0,r.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.default,t.prev=1,e.current=new s({enableWebRtc:!1,wrcWindowMode:!0,clickCutFullScreen:!0,completeCallback:function(e){e.base64,e.cutInfo;c(!1),a.getTracks().forEach((function(e){return e.stop()})),console.log("completeCallback")}}),t.abrupt("return",{status:"success",message:"\u622a\u5c4f\u6210\u529f"});case 6:return t.prev=6,t.t0=t.catch(1),console.error("\u622a\u5c4f\u65f6\u53d1\u751f\u9519\u8bef:",(null==t.t0?void 0:t.t0.message)||t.t0),a.getTracks().forEach((function(e){return e.stop()})),t.abrupt("return",{status:"failure",message:"\u622a\u5c4f\u65f6\u53d1\u751f\u9519\u8bef: "+((null==t.t0?void 0:t.t0.message)||t.t0)});case 11:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){return console.error("\u622a\u5c4f\u65f6\u53d1\u751f\u9519\u8bef:",e.message),a.getTracks().forEach((function(e){return e.stop()})),{status:"failure",message:"\u622a\u5c4f\u65f6\u53d1\u751f\u9519\u8bef: "+e.message}})));case 8:if(t.prev=8,t.t0=t.catch(0),"NotAllowedError"!==t.t0.name){t.next=14;break}return t.abrupt("return",{status:"denied",message:"\u7528\u6237\u62d2\u7edd\u4e86\u5c4f\u5e55\u5171\u4eab\u6743\u9650\u8bf7\u6c42"});case 14:if("NotFoundError"!==t.t0.name){t.next=18;break}return t.abrupt("return",{status:"unsupported",message:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5c4f\u5e55\u5171\u4eab\u529f\u80fd"});case 18:return console.error("\u5c4f\u5e55\u5171\u4eab\u6743\u9650\u8bf7\u6c42\u5931\u8d25:",t.t0),t.abrupt("return",{status:"failure",message:"\u5c4f\u5e55\u5171\u4eab\u6743\u9650\u8bf7\u6c42\u5931\u8d25: "+t.t0.message});case 20:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();return{handleScreenShot:u,UrlOverlay:function(){window.location.href;return(0,l.jsx)(S.A,{id:"urlOverlay",style:{position:"fixed",bottom:"10px",left:"10px",padding:"5px",display:i?"block":"none"},children:(0,l.jsx)(m,{})})}}}var m=function(){var e=window.location.href;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:e}),(0,l.jsx)(g.Ay,{value:e,size:76.2})," "]})};var A={read:1020,like:500,comment:390,share:1e4,collect:2e5},w=new p,x={},D=[{icon:(0,l.jsx)(o.A,{}),id:"collect",counts:1234,isDone:!1},{icon:(0,l.jsx)(u.A,{}),id:"share",counts:1234,isDone:!1},{icon:(0,l.jsx)(c.A,{}),id:"comment",counts:1234,isDone:!1},{icon:(0,l.jsx)(i.A,{}),id:"like",counts:1234,isDone:!1},{icon:(0,l.jsx)(f.A,{}),id:"read",counts:1234,isDone:!0},{icon:(0,l.jsx)(h.A,{}),id:"follow",counts:1234,isDone:!1}].map((function(e,t){var n;return e.counts=null!=(n=A[e.id])?n:0,x[e.id]=t,e}));function E(){var e=a.useState(0),t=(e[0],e[1]),n=v(),i=n.handleScreenShot,c=n.UrlOverlay,u=a.useState(D),o=u[0],h=u[1],l=function(){var e=(0,s.A)((0,r.A)().mark((function e(n){var s,a,c,u;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="share"!==n&&"read"!==n,"share"!==n){e.next=7;break}return e.next=4,i();case 4:if(c=e.sent,null==(a=!c||"success"!==(null==c?void 0:c.status))||!a){e.next=7;break}return e.abrupt("return");case 7:h((function(e){return e.map((function(e){if(e.id!==n)return e;var t,r=(void 0===(t=D)&&(t=o),t[x[n]]),a=!e.isDone,i=r.isDone!==a;return Object.assign({},e,{isDone:!s||a,counts:s?i?r.counts+(a?1:-1):r.counts:e.counts+1})}))})),"read"===n&&(u=w.startReading("",w.readingState),t(u));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{socials:o,handleAction:l,handleScreenShot:i,UrlOverlay:c}}}}]);